<?xml version="1.0" encoding="utf-8"?>
<Application>
	<Name>DTK Quellmosaik Col</Name>
	<Command>CM+SP+SE+AR+AR+CV+IG+BB+ERF+SE+DO+SE+BO</Command>
	<Workspace>
		<WorkspacePath>$workspace$</WorkspacePath>
		<Geodatabase>$gdbName$</Geodatabase>
		<MosaicDataset>
			<MosaicDatasetType>source</MosaicDatasetType>
			<Name>D_col</Name>
			<SRS>25832;$srs$</SRS>
			<num_bands>1</num_bands>
			<pixel_type>8_BIT_UNSIGNED</pixel_type>
			<product_definition>None</product_definition>
			<DefaultProperties>
				<max_num_per_mosaic>50</max_num_per_mosaic>
				<allowed_compressions>LZ77;None;JPEG</allowed_compressions>
				<default_compression_type>LZ77</default_compression_type>
				<JPEG_quality>80</JPEG_quality>
				<LERC_Tolerance>0.1</LERC_Tolerance>
				<resampling_type>NEAREST</resampling_type>
				<clip_to_footprints>CLIP</clip_to_footprints>
				<clip_to_boundary>CLIP</clip_to_boundary>
				<color_correction>NOT_APPLY</color_correction>
				<footprints_may_contain_nodata>FOOTPRINTS_DO_NOT_CONTAIN_NODATA</footprints_may_contain_nodata>
				<allowed_mensuration_capabilities>BASIC</allowed_mensuration_capabilities>
				<default_mensuration_capabilities>BASIC</default_mensuration_capabilities>
				<allowed_mosaic_methods>NorthWest;LockRaster;ByAttribute;None</allowed_mosaic_methods>
				<default_mosaic_method>ByAttribute</default_mosaic_method>
				<order_field>ZOrder</order_field>
				<order_base>0</order_base>
				<sorting_order>ASCENDING</sorting_order>
				<mosaic_operator>FIRST</mosaic_operator>
				<blend_width>10</blend_width>
				<view_point_x>300</view_point_x>
				<view_point_y>300</view_point_y>
				<max_num_per_mosaic>500</max_num_per_mosaic>
				<cell_size_tolerance>0.8</cell_size_tolerance>
				<cell_size>$cellSize$</cell_size>
				<metadata_level>BASIC</metadata_level>
				<transmission_fields>MinPS;MaxPS;LowPS;HighPS;CenterX;CenterY;ZOrder;Shape_Length;Shape_Area;Land;Eigentuemer;Aktualitaet_Kachelinformationen;Version_Standard;Aktualitaet;Erfassungsmethode;Bildflugnummer;Kamera_Sensor;Bodenpixelgroesse;Spektralkanaele;Koordinatenreferenzssystem_Lage;Koordinatenreferenzssystem_Hoehe;Bezugsflaeche;Koordinatenursprung_East;Koordinatenursprung_North;Standardabweichung;Quelldatenqualitaet;Belaubungszustand;Bemerkungen</transmission_fields>
				<use_time>DISABLED</use_time>
				<geographic_transform>DHDN_To_ETRS_1989_8_NTv2;DHDN_To_WGS_1984_4_NTv2</geographic_transform>
				<max_num_of_download_items>200</max_num_of_download_items>
				<max_num_of_records_returned>2000</max_num_of_records_returned>
				<data_source_type>THEMATIC</data_source_type>
				<minimum_pixel_contribution>50</minimum_pixel_contribution>
				<time_interval_units>None</time_interval_units>
			</DefaultProperties>
			<AddRasters>
				<AddRaster>
					<dataset_id>$id$</dataset_id>
					<raster_type>Table</raster_type>
					<Sources>
						<data_path>\\lswfsdtk1\dtk2\DTK-N-Repository\Ressourcen\dtk$massstab$_Bestand.gdb\dtk$massstab$_col_utm32s</data_path>
					</Sources>
					<update_cellsize_ranges>UPDATE_CELL_SIZES</update_cellsize_ranges>
					<update_boundary>NO_BOUNDARY</update_boundary>
					<update_overviews>NO_OVERVIEWS</update_overviews>
					<sub_folder>SUBFOLDERS</sub_folder>
					<duplicate_items_action>OVERWRITE_DUPLICATES</duplicate_items_action>
					<build_pyramids>NO_PYRAMIDS</build_pyramids>
					<calculate_statistics>NO_STATISTICS</calculate_statistics>
					<build_thumbnails>NO_THUMBNAILS</build_thumbnails>
					<operation_description/>
					<force_spatial_reference>NO_FORCE_SPATIAL_REFERENCE</force_spatial_reference>
					<estimate_statistics>NO_STATISTICS</estimate_statistics>
					<enable_pixel_cache>NO_PIXEL_CACHE</enable_pixel_cache>
					<cache_location>D:\TEMP_ESRI\rasterproxies</cache_location>
				</AddRaster>
			</AddRasters>
			<Processes>
				<EditRasterFunction>
					<edit_mosaic_dataset_item>EDIT_MOSAIC_DATASET</edit_mosaic_dataset_item>
					<edit_options>INSERT</edit_options>
					<function_chain_definition>DTK-Colormap_PQS1.0.rft.xml</function_chain_definition>
					<location_function_name>Mosaic Function</location_function_name>
				</EditRasterFunction>
				<BuildBoundary>
					<append_to_existing>OVERWRITE</append_to_existing>
					<simplification_method>ENVELOPE</simplification_method>
				</BuildBoundary>
				<DefineOverviews>
					<pixel_size>$cellSize$</pixel_size>
					<number_of_levels>3</number_of_levels>
					<overview_factor>4</overview_factor>
					<force_overview_tiles>NO_FORCE_OVERVIEW_TILES</force_overview_tiles>
					<resampling_method>NEAREST</resampling_method>
					<compression_method>LZW</compression_method>
					<compression_quality>75</compression_quality>
				</DefineOverviews>
				<BuildOverviews>
					<define_missing_tiles>DEFINE_MISSING_TILES</define_missing_tiles>
					<generate_overviews>GENERATE_OVERVIEWS</generate_overviews>
					<generate_missing_images>GENERATE_MISSING_IMAGES</generate_missing_images>
					<regenerate_stale_images>REGENERATE_STALE_IMAGES</regenerate_stale_images>
				</BuildOverviews>
				<JoinField>
					<in_data>d:\test.gdb\AMD_mdName_SML</in_data>
					<in_field>RasterID</in_field>
					<join_table>d:\test.gdb\AMD_mdName_CAT</join_table>
					<join_field>OBJECTID</join_field>
					<fields>list_of_fields_to_joined</fields>
				</JoinField>
				<CalculateValues>
					<CalculateValue>
						<fieldName>GroupName</fieldName>
						<expression>splitLayerName(!Name!)</expression>
						<expression_type>PYTHON3</expression_type>
						<code_block>import re
def splitLayerName(value):
  mo = re.search('^dtk(25|50|100)[_]\d{4,5}[_]\d{4}[_]\d+[_][a-z]{2}|^[lc]?\d{4}', value.lower())
  try:
    return mo.group()
  except AttributeError:
    return None
						</code_block>
					</CalculateValue>
				</CalculateValues>
				<AddIndex>
					<Index>
						<fields>name_of_field_to_be_indexed</fields>
						<index_name>index_name</index_name>
						<unique>unique</unique>
						<ascending>ascending</ascending>
					</Index>
					<Index>
						<fields>name_of_field_to_be_indexed</fields>
						<index_name>index_name</index_name>
						<unique>unique</unique>
						<ascending>ascending</ascending>
					</Index>
				</AddIndex>
				<Environment>
					<parallelProcessingFactor>150%</parallelProcessingFactor>
				</Environment>
				<ImportGeometry>
					<target_featureclass_type>FOOTPRINT</target_featureclass_type>
					<target_join_field>GroupName</target_join_field>
					<input_featureclass>\\lswfsdtk1\dtk2\DTK-N-Repository\Ressourcen\DTK-N_Erfassungseinheiten.gdb\b$massstab$_utm3$utm$s</input_featureclass>
					<input_join_field>DTKNR</input_join_field>
				</ImportGeometry>
				<ImportFieldValues>
					<target_join_field>GroupName</target_join_field>
					<input_featureclass>$metaFile$</input_featureclass>
					<input_join_field>Name</input_join_field>
					<fieldNameList>SK-Version;Bildflug;Topographie;Spitzenaktualitaet;Georeferenzierung</fieldNameList>
				</ImportFieldValues>
				<ExportMosaicDatasetGeometry>
					<out_feature_class>$workspace$\$gdbName$.gdb\S_col_Footprint</out_feature_class>
					<where_clause>Category = 1</where_clause>
					<geometry_type>FOOTPRINT</geometry_type>
				</ExportMosaicDatasetGeometry>
			</Processes>
		</MosaicDataset>
	</Workspace>
</Application>